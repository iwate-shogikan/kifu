#!/usr/bin/env bash
set -euo pipefail

# ログが出来るか最小テスト
echo "fired $(date)" >> ".git/hooks/post-commit.log"

# どのブランチか表示
BR="$(git rev-parse --abbrev-ref HEAD)"
echo "[post-commit] branch=$BR" >&2

# main のときだけ push（必要なら条件外してOK）
if [[ "$BR" == "main" ]]; then
  echo "[post-commit] pushing to origin $BR ..." >&2
  git push origin "$BR"
else
  echo "[post-commit] skip push (not main)" >&2
fi
